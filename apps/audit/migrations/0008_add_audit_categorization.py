# Generated by Django 5.2.5 on 2025-08-28 12:04

from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ("audit", "0007_alter_auditevent_action_alter_dataexport_file_path_and_more"),
        ("contenttypes", "0002_remove_content_type_name"),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name="auditevent",
            name="category",
            field=models.CharField(
                choices=[
                    ("authentication", "Authentication"),
                    ("authorization", "Authorization"),
                    ("account_management", "Account Management"),
                    ("data_protection", "Data Protection"),
                    ("security_event", "Security Event"),
                    ("business_operation", "Business Operation"),
                    ("system_admin", "System Administration"),
                    ("compliance", "Compliance"),
                    ("privacy", "Privacy"),
                    ("integration", "Integration"),
                ],
                db_index=True,
                default="business_operation",
                max_length=30,
            ),
        ),
        migrations.AddField(
            model_name="auditevent",
            name="is_sensitive",
            field=models.BooleanField(db_index=True, default=False),
        ),
        migrations.AddField(
            model_name="auditevent",
            name="requires_review",
            field=models.BooleanField(db_index=True, default=False),
        ),
        migrations.AddField(
            model_name="auditevent",
            name="severity",
            field=models.CharField(
                choices=[
                    ("low", "Low"),
                    ("medium", "Medium"),
                    ("high", "High"),
                    ("critical", "Critical"),
                ],
                db_index=True,
                default="low",
                max_length=10,
            ),
        ),
        migrations.AlterField(
            model_name="auditevent",
            name="action",
            field=models.CharField(
                choices=[
                    ("create", "Create"),
                    ("update", "Update"),
                    ("delete", "Delete"),
                    ("view", "View"),
                    ("access", "Access"),
                    ("export", "Export"),
                    ("import", "Import"),
                    ("login_success", "Login Success"),
                    ("login_failed", "Login Failed"),
                    ("login_failed_password", "Login Failed - Invalid Password"),
                    ("login_failed_user_not_found", "Login Failed - User Not Found"),
                    ("login_failed_account_locked", "Login Failed - Account Locked"),
                    ("login_failed_2fa", "Login Failed - 2FA Verification"),
                    ("logout_manual", "Manual Logout"),
                    ("logout_session_expired", "Session Expired Logout"),
                    ("logout_concurrent_session", "Concurrent Session Logout"),
                    ("logout_security_event", "Security Event Logout"),
                    ("account_locked", "Account Locked"),
                    ("account_unlocked", "Account Unlocked"),
                    ("session_rotation", "Session Rotation"),
                    ("session_terminated", "Session Terminated"),
                    ("password_changed", "Password Changed"),
                    ("password_reset_requested", "Password Reset Requested"),
                    ("password_reset_completed", "Password Reset Completed"),
                    ("password_reset_failed", "Password Reset Failed"),
                    ("password_strength_weak", "Weak Password Attempted"),
                    ("password_compromised", "Compromised Password Detected"),
                    ("password_expired", "Password Expired"),
                    ("password_policy_violation", "Password Policy Violation"),
                    ("2fa_enabled", "2FA Enabled"),
                    ("2fa_disabled", "2FA Disabled"),
                    ("2fa_admin_reset", "2FA Admin Reset"),
                    ("2fa_backup_codes_generated", "2FA Backup Codes Generated"),
                    ("2fa_backup_codes_viewed", "2FA Backup Codes Viewed"),
                    ("2fa_backup_code_used", "2FA Backup Code Used"),
                    ("2fa_secret_regenerated", "2FA Secret Regenerated"),
                    ("2fa_verification_success", "2FA Verification Success"),
                    ("2fa_verification_failed", "2FA Verification Failed"),
                    ("2fa_setup_started", "2FA Setup Started"),
                    ("2fa_setup_completed", "2FA Setup Completed"),
                    ("2fa_recovery_used", "2FA Recovery Code Used"),
                    ("2fa_device_registered", "2FA Device Registered"),
                    ("2fa_device_removed", "2FA Device Removed"),
                    ("profile_updated", "Profile Updated"),
                    ("profile_picture_changed", "Profile Picture Changed"),
                    ("email_changed", "Email Address Changed"),
                    ("email_verification_requested", "Email Verification Requested"),
                    ("email_verification_completed", "Email Verification Completed"),
                    ("phone_updated", "Phone Number Updated"),
                    ("phone_verification_requested", "Phone Verification Requested"),
                    ("phone_verification_completed", "Phone Verification Completed"),
                    ("name_changed", "Name Changed"),
                    ("language_preference_changed", "Language Preference Changed"),
                    ("timezone_changed", "Timezone Changed"),
                    ("emergency_contact_updated", "Emergency Contact Updated"),
                    ("privacy_settings_changed", "Privacy Settings Changed"),
                    ("marketing_consent_granted", "Marketing Consent Granted"),
                    ("marketing_consent_withdrawn", "Marketing Consent Withdrawn"),
                    ("gdpr_consent_granted", "GDPR Consent Granted"),
                    ("gdpr_consent_withdrawn", "GDPR Consent Withdrawn"),
                    (
                        "data_processing_consent_changed",
                        "Data Processing Consent Changed",
                    ),
                    ("cookie_consent_updated", "Cookie Consent Updated"),
                    ("privacy_policy_accepted", "Privacy Policy Accepted"),
                    ("terms_of_service_accepted", "Terms of Service Accepted"),
                    ("notification_settings_changed", "Notification Settings Changed"),
                    ("email_notifications_toggled", "Email Notifications Toggled"),
                    ("sms_notifications_toggled", "SMS Notifications Toggled"),
                    ("push_notifications_toggled", "Push Notifications Toggled"),
                    (
                        "notification_frequency_changed",
                        "Notification Frequency Changed",
                    ),
                    ("role_assigned", "Role Assigned"),
                    ("role_removed", "Role Removed"),
                    ("permission_granted", "Permission Granted"),
                    ("permission_revoked", "Permission Revoked"),
                    ("access_denied", "Access Denied"),
                    ("privilege_escalation_attempt", "Privilege Escalation Attempt"),
                    ("staff_role_changed", "Staff Role Changed"),
                    ("customer_role_changed", "Customer Role Changed"),
                    ("customer_membership_created", "Customer Membership Created"),
                    ("customer_membership_updated", "Customer Membership Updated"),
                    ("customer_membership_deleted", "Customer Membership Deleted"),
                    ("primary_customer_changed", "Primary Customer Changed"),
                    ("customer_access_granted", "Customer Access Granted"),
                    ("customer_access_revoked", "Customer Access Revoked"),
                    ("customer_context_switched", "Customer Context Switched"),
                    ("api_key_generated", "API Key Generated"),
                    ("api_key_regenerated", "API Key Regenerated"),
                    ("api_key_revoked", "API Key Revoked"),
                    ("api_key_used", "API Key Used"),
                    ("api_access_denied", "API Access Denied"),
                    ("webhook_configured", "Webhook Configured"),
                    ("webhook_updated", "Webhook Updated"),
                    ("webhook_removed", "Webhook Removed"),
                    ("security_incident_detected", "Security Incident Detected"),
                    ("suspicious_activity", "Suspicious Activity"),
                    ("brute_force_attempt", "Brute Force Attempt"),
                    ("ip_blocked", "IP Address Blocked"),
                    ("ip_unblocked", "IP Address Unblocked"),
                    ("rate_limit_exceeded", "Rate Limit Exceeded"),
                    ("malicious_request", "Malicious Request Detected"),
                    ("security_scan_detected", "Security Scan Detected"),
                    ("data_export_requested", "Data Export Requested"),
                    ("data_export_completed", "Data Export Completed"),
                    ("data_export_downloaded", "Data Export Downloaded"),
                    ("data_deletion_requested", "Data Deletion Requested"),
                    ("data_deletion_completed", "Data Deletion Completed"),
                    ("data_anonymization_completed", "Data Anonymization Completed"),
                    ("data_breach_detected", "Data Breach Detected"),
                    ("data_breach_contained", "Data Breach Contained"),
                    ("data_breach_reported", "Data Breach Reported"),
                    ("invoice_accessed", "Invoice Accessed"),
                    ("invoice_downloaded", "Invoice Downloaded"),
                    ("payment_method_added", "Payment Method Added"),
                    ("payment_method_updated", "Payment Method Updated"),
                    ("payment_method_removed", "Payment Method Removed"),
                    ("billing_address_updated", "Billing Address Updated"),
                    ("tax_information_updated", "Tax Information Updated"),
                    ("order_placed", "Order Placed"),
                    ("order_cancelled", "Order Cancelled"),
                    ("service_activated", "Service Activated"),
                    ("service_suspended", "Service Suspended"),
                    ("support_ticket_created", "Support Ticket Created"),
                    ("support_ticket_updated", "Support Ticket Updated"),
                    ("support_ticket_closed", "Support Ticket Closed"),
                    ("system_maintenance_started", "System Maintenance Started"),
                    ("system_maintenance_completed", "System Maintenance Completed"),
                    ("backup_created", "Backup Created"),
                    ("backup_restored", "Backup Restored"),
                    ("configuration_changed", "Configuration Changed"),
                    ("user_impersonation_started", "User Impersonation Started"),
                    ("user_impersonation_ended", "User Impersonation Ended"),
                    ("bulk_operation_started", "Bulk Operation Started"),
                    ("bulk_operation_completed", "Bulk Operation Completed"),
                ],
                db_index=True,
                max_length=50,
            ),
        ),
        migrations.AddIndex(
            model_name="auditevent",
            index=models.Index(
                fields=["category", "-timestamp"], name="idx_audit_category_time"
            ),
        ),
        migrations.AddIndex(
            model_name="auditevent",
            index=models.Index(
                fields=["severity", "-timestamp"], name="idx_audit_severity_time"
            ),
        ),
        migrations.AddIndex(
            model_name="auditevent",
            index=models.Index(
                fields=["is_sensitive", "-timestamp"], name="idx_audit_sensitive_time"
            ),
        ),
        migrations.AddIndex(
            model_name="auditevent",
            index=models.Index(
                fields=["requires_review", "-timestamp"], name="idx_audit_review_time"
            ),
        ),
        migrations.AddIndex(
            model_name="auditevent",
            index=models.Index(
                fields=["category", "severity", "-timestamp"],
                name="idx_audit_cat_sev_time",
            ),
        ),
        migrations.AddIndex(
            model_name="auditevent",
            index=models.Index(
                fields=["user", "category", "-timestamp"],
                name="idx_audit_user_cat_time",
            ),
        ),
        migrations.AddIndex(
            model_name="auditevent",
            index=models.Index(
                fields=["ip_address", "severity", "-timestamp"],
                name="idx_audit_ip_sev_time",
            ),
        ),
        migrations.AddIndex(
            model_name="auditevent",
            index=models.Index(
                fields=["user", "category", "is_sensitive", "-timestamp"],
                name="idx_audit_compliance",
            ),
        ),
        migrations.AddIndex(
            model_name="auditevent",
            index=models.Index(
                fields=["timestamp", "category"], name="idx_audit_time_cat"
            ),
        ),
    ]
