{% comment %}
===============================================================================
ðŸ“„ MODERN PAGINATION COMPONENT - PRAHO Platform
===============================================================================
Adapted from modern Shadcn/UI pagination with PRAHO Platform integration.
Clean, accessible, and responsive pagination following 2024 UI best practices.

Usage:
{% include 'components/pagination.html' with page_obj=page_obj %}
{% include 'components/pagination.html' with page_obj=invoices extra_params='&filter=pending' %}
{% include 'components/pagination.html' with page_obj=logs htmx_target='#results' htmx_url='/app/audit/logs/list/' %}

Required Parameters:
- page_obj: Django paginator page object (has_previous, has_next, etc.)

Optional Parameters:
- extra_params: Additional URL parameters to preserve (e.g., "&search=query&filter=active")
- css_class: Additional CSS classes for the container
- show_info: Show results info above pagination (default: True)
- htmx_target: HTMX target selector for dynamic loading
- htmx_url: Base URL for HTMX requests (defaults to current page if not provided)

Features:
- âœ… Modern Shadcn UI design
- âœ… Responsive (mobile + desktop)
- âœ… Full accessibility (ARIA, keyboard nav)
- âœ… Romanian translations
- âœ… Smart page range with ellipsis
- âœ… HTMX integration ready
- âœ… Preserves query parameters
===============================================================================
{% endcomment %}

{% load i18n %}

{# Always show pagination for now #}

{# Pagination Container with Left/Right Layout #}
<div class="flex items-center justify-between py-4 px-4 {{ css_class|default:'' }}">

  {# Results Information - Left Side with Button-like Styling #}
  {% if show_info|default:True %}
    <div class="inline-flex items-center justify-center py-4 px-3 sm:px-4 bg-slate-800/30 backdrop-blur-sm border border-slate-700/40 rounded-lg shadow-lg text-sm text-slate-300">
      {% with page_obj.start_index as start_index and page_obj.end_index as end_index and page_obj.paginator.count as count %}
        {# Consistent format for both mobile and desktop #}
        <span>
          {% filter force_escape %}{% blocktrans %}
            {{ start_index }}â€“{{ end_index }} of {{ count }} results
          {% endblocktrans %}{% endfilter %}
        </span>
      {% endwith %}
    </div>
  {% endif %}

  {# Modern Pagination Navigation - Right Side #}
  <nav role="navigation" aria-label="{% trans 'Pagination' %}" data-slot="pagination" class="flex justify-end">
    <ul data-slot="pagination-content" class="inline-flex items-center gap-0.5 sm:gap-1 bg-slate-800/30 backdrop-blur-sm border border-slate-700/40 rounded-lg px-1.5 py-1.5 sm:px-2 sm:py-2 shadow-lg">

    {# Previous Page Button #}
    <li data-slot="pagination-item">
      {% if page_obj.has_previous %}
        <a data-slot="pagination-link"
           class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:ring-2 focus-visible:ring-slate-400/50 focus-visible:ring-offset-1 hover:bg-slate-700/60 hover:text-slate-100 active:bg-slate-600/80 h-8 sm:h-9 py-2 px-2 sm:px-3 gap-1 sm:gap-2 text-slate-300 border border-transparent hover:border-slate-600/50"
           aria-label="{% trans 'Go to previous page' %}"
           href="?page={{ page_obj.previous_page_number }}{{ extra_params|default:'' }}"
           {% if htmx_target %}hx-get="{% if htmx_url %}{{ htmx_url }}{% endif %}?page={{ page_obj.previous_page_number }}{{ extra_params|default:'' }}" hx-target="{{ htmx_target }}" hx-push-url="true"{% endif %}>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left">
            <path d="m15 18-6-6 6-6"></path>
          </svg>
          <span class="hidden sm:block">{% trans 'Previous' %}</span>
        </a>
      {% else %}
        <span data-slot="pagination-link"
              class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none h-8 sm:h-9 py-2 px-2 sm:px-3 gap-1 sm:gap-2 text-slate-500 cursor-not-allowed border border-transparent"
              aria-label="{% trans 'Previous page (unavailable)' %}">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left">
            <path d="m15 18-6-6 6-6"></path>
          </svg>
          <span class="hidden sm:block">{% trans 'Previous' %}</span>
        </span>
      {% endif %}
    </li>

    {# Smart Page Range Logic #}
    {% with page_obj.number as current_page and page_obj.paginator.num_pages as total_pages %}

      {# First page (if not in visible range) #}
      {% if current_page > 3 %}
        <li data-slot="pagination-item">
          <a data-slot="pagination-link"
             class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 outline-none focus-visible:ring-2 focus-visible:ring-slate-400/50 focus-visible:ring-offset-1 hover:bg-slate-700/60 hover:text-slate-100 active:bg-slate-600/80 size-8 sm:size-9 text-slate-300 border border-transparent hover:border-slate-600/50"
             href="?page=1{{ extra_params|default:'' }}"
             {% if htmx_target %}hx-get="{% if htmx_url %}{{ htmx_url }}{% endif %}?page=1{{ extra_params|default:'' }}" hx-target="{{ htmx_target }}" hx-push-url="true"{% endif %}>
            1
          </a>
        </li>

        {% if current_page > 4 %}
          <li data-slot="pagination-item">
            <span aria-hidden="true" data-slot="pagination-ellipsis" class="flex size-8 sm:size-9 items-center justify-center text-slate-400">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ellipsis size-4">
                <circle cx="12" cy="12" r="1"></circle>
                <circle cx="19" cy="12" r="1"></circle>
                <circle cx="5" cy="12" r="1"></circle>
              </svg>
              <span class="sr-only">{% trans 'More pages' %}</span>
            </span>
          </li>
        {% endif %}
      {% endif %}

      {# Page range around current page #}
      {% for page_num in page_obj.paginator.page_range %}
        {% if page_num >= current_page|add:"-2" and page_num <= current_page|add:"2" %}
          <li data-slot="pagination-item">
            {% if page_num == current_page %}
              <a aria-current="page"
                 data-slot="pagination-link"
                 data-active="true"
                 class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 outline-none focus-visible:ring-2 focus-visible:ring-slate-400/50 focus-visible:ring-offset-1 border bg-slate-700/90 border-slate-600/80 shadow-sm hover:bg-slate-600/90 hover:text-slate-50 active:bg-slate-600/80 size-8 sm:size-9 text-slate-100 font-semibold"
                 href="?page={{ page_num }}{{ extra_params|default:'' }}">
                {{ page_num }}
              </a>
            {% else %}
              <a data-slot="pagination-link"
                 class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 outline-none focus-visible:ring-2 focus-visible:ring-slate-400/50 focus-visible:ring-offset-1 hover:bg-slate-700/60 hover:text-slate-100 active:bg-slate-600/80 size-8 sm:size-9 text-slate-300 border border-transparent hover:border-slate-600/50"
                 href="?page={{ page_num }}{{ extra_params|default:'' }}"
                 {% if htmx_target %}hx-get="{% if htmx_url %}{{ htmx_url }}{% endif %}?page={{ page_num }}{{ extra_params|default:'' }}" hx-target="{{ htmx_target }}" hx-push-url="true"{% endif %}>
                {{ page_num }}
              </a>
            {% endif %}
          </li>
        {% endif %}
      {% endfor %}

      {# Last page (if not in visible range) #}
      {% if current_page < total_pages|add:"-2" %}
        {% if current_page < total_pages|add:"-3" %}
          <li data-slot="pagination-item">
            <span aria-hidden="true" data-slot="pagination-ellipsis" class="flex size-8 sm:size-9 items-center justify-center text-slate-400">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ellipsis size-4">
                <circle cx="12" cy="12" r="1"></circle>
                <circle cx="19" cy="12" r="1"></circle>
                <circle cx="5" cy="12" r="1"></circle>
              </svg>
              <span class="sr-only">{% trans 'More pages' %}</span>
            </span>
          </li>
        {% endif %}

        <li data-slot="pagination-item">
          <a data-slot="pagination-link"
             class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 outline-none focus-visible:ring-2 focus-visible:ring-slate-400/50 focus-visible:ring-offset-1 hover:bg-slate-700/60 hover:text-slate-100 active:bg-slate-600/80 size-8 sm:size-9 text-slate-300 border border-transparent hover:border-slate-600/50"
             href="?page={{ total_pages }}{{ extra_params|default:'' }}"
             {% if htmx_target %}hx-get="{% if htmx_url %}{{ htmx_url }}{% endif %}?page={{ total_pages }}{{ extra_params|default:'' }}" hx-target="{{ htmx_target }}" hx-push-url="true"{% endif %}>
            {{ total_pages }}
          </a>
        </li>
      {% endif %}

    {% endwith %}

    {# Next Page Button #}
    <li data-slot="pagination-item">
      {% if page_obj.has_next %}
        <a data-slot="pagination-link"
           class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:ring-2 focus-visible:ring-slate-400/50 focus-visible:ring-offset-1 hover:bg-slate-700/60 hover:text-slate-100 active:bg-slate-600/80 h-8 sm:h-9 py-2 px-2 sm:px-3 gap-1 sm:gap-2 text-slate-300 border border-transparent hover:border-slate-600/50"
           aria-label="{% trans 'Go to next page' %}"
           href="?page={{ page_obj.next_page_number }}{{ extra_params|default:'' }}"
           {% if htmx_target %}hx-get="{% if htmx_url %}{{ htmx_url }}{% endif %}?page={{ page_obj.next_page_number }}{{ extra_params|default:'' }}" hx-target="{{ htmx_target }}" hx-push-url="true"{% endif %}>
          <span class="hidden sm:block">{% trans 'Next' %}</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right">
            <path d="m9 18 6-6-6-6"></path>
          </svg>
        </a>
      {% else %}
        <span data-slot="pagination-link"
              class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none h-8 sm:h-9 py-2 px-2 sm:px-3 gap-1 sm:gap-2 text-slate-500 cursor-not-allowed border border-transparent"
              aria-label="{% trans 'Next page (unavailable)' %}">
          <span class="hidden sm:block">{% trans 'Next' %}</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right">
            <path d="m9 18 6-6-6-6"></path>
          </svg>
        </span>
      {% endif %}
    </li>

    </ul>
  </nav>

</div>
