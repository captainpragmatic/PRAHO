# Generated by Django 5.2.5 on 2025-09-13 15:07

import django.core.validators
import django.db.models.deletion
import uuid
from decimal import Decimal
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('customers', '0001_initial'),
        ('domains', '0002_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='VirtualminAccount',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('domain', models.CharField(db_index=True, help_text='Must be unique across all VirtualMin accounts', max_length=255, unique=True, verbose_name='Primary Domain')),
                ('virtualmin_username', models.CharField(db_index=True, help_text='Unique Virtualmin virtual server username', max_length=32, unique=True, verbose_name='Virtualmin Username')),
                ('encrypted_password', models.BinaryField(verbose_name='Encrypted Password')),
                ('template_name', models.CharField(default='Default', max_length=50, verbose_name='Virtualmin Template')),
                ('domains', models.JSONField(default=list, help_text='All domains managed by this Virtualmin account')),
                ('disk_quota_mb', models.PositiveIntegerField(blank=True, null=True, verbose_name='Disk Quota (MB)')),
                ('bandwidth_quota_mb', models.IntegerField(blank=True, help_text='Use -1 for unlimited bandwidth', null=True, verbose_name='Bandwidth Quota (MB)')),
                ('status', models.CharField(choices=[('provisioning', 'Provisioning'), ('active', 'Active'), ('suspended', 'Suspended'), ('terminated', 'Terminated'), ('error', 'Error')], default='provisioning', max_length=20, verbose_name='Status')),
                ('status_message', models.TextField(blank=True)),
                ('protected_from_deletion', models.BooleanField(default=True, help_text='Prevents accidental deletion of active Virtualmin accounts', verbose_name='Protected from Deletion')),
                ('praho_customer_id', models.PositiveIntegerField(blank=True, help_text='Stored in Virtualmin comment for recovery', null=True)),
                ('praho_service_id', models.UUIDField(blank=True, help_text='Stored in Virtualmin comment for recovery', null=True)),
                ('features', models.JSONField(default=dict, help_text='Virtualmin features enabled for this account')),
                ('current_disk_usage_mb', models.PositiveIntegerField(default=0)),
                ('current_bandwidth_usage_mb', models.PositiveIntegerField(default=0)),
                ('provisioned_at', models.DateTimeField(blank=True, null=True)),
                ('last_sync_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Virtualmin Account',
                'verbose_name_plural': 'Virtualmin Accounts',
                'db_table': 'virtualmin_accounts',
                'ordering': ('-created_at',),
            },
        ),
        migrations.CreateModel(
            name='VirtualminDriftRecord',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('domain', models.CharField(db_index=True, max_length=255)),
                ('drift_type', models.CharField(choices=[('missing_in_virtualmin', 'Missing in Virtualmin'), ('missing_in_praho', 'Missing in PRAHO'), ('status_mismatch', 'Status Mismatch'), ('quota_mismatch', 'Quota Mismatch'), ('feature_mismatch', 'Feature Mismatch'), ('metadata_mismatch', 'Metadata Mismatch')], max_length=30)),
                ('description', models.TextField()),
                ('praho_state', models.JSONField(default=dict)),
                ('virtualmin_state', models.JSONField(default=dict)),
                ('resolution_status', models.CharField(choices=[('pending', 'Pending'), ('auto_fixed', 'Auto Fixed'), ('manual_fixed', 'Manual Fixed'), ('ignored', 'Ignored')], default='pending', max_length=20)),
                ('resolution_notes', models.TextField(blank=True)),
                ('resolved_at', models.DateTimeField(blank=True, null=True)),
                ('resolved_by', models.CharField(blank=True, max_length=100)),
                ('detected_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Virtualmin Drift Record',
                'verbose_name_plural': 'Virtualmin Drift Records',
                'db_table': 'virtualmin_drift_records',
                'ordering': ('-detected_at',),
            },
        ),
        migrations.CreateModel(
            name='VirtualminProvisioningJob',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('correlation_id', models.CharField(db_index=True, help_text='Correlation ID for tracking across systems', max_length=100)),
                ('operation', models.CharField(choices=[('create_domain', 'Create Domain'), ('delete_domain', 'Delete Domain'), ('modify_domain', 'Modify Domain'), ('suspend_domain', 'Suspend Domain'), ('unsuspend_domain', 'Unsuspend Domain'), ('create_user', 'Create User'), ('delete_user', 'Delete User'), ('create_database', 'Create Database'), ('delete_database', 'Delete Database'), ('install_ssl', 'Install SSL Certificate'), ('backup_domain', 'Backup Domain'), ('restore_domain', 'Restore Domain')], max_length=30)),
                ('parameters', models.JSONField(default=dict)),
                ('result', models.JSONField(default=dict)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('running', 'Running'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('status_message', models.TextField(blank=True)),
                ('retry_count', models.PositiveIntegerField(default=0)),
                ('max_retries', models.PositiveIntegerField(default=3)),
                ('next_retry_at', models.DateTimeField(blank=True, null=True)),
                ('started_at', models.DateTimeField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('execution_time_seconds', models.DecimalField(blank=True, decimal_places=3, max_digits=10, null=True)),
                ('task_id', models.CharField(blank=True, db_index=True, max_length=255)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Virtualmin Provisioning Job',
                'verbose_name_plural': 'Virtualmin Provisioning Jobs',
                'db_table': 'virtualmin_provisioning_jobs',
                'ordering': ('-created_at',),
            },
        ),
        migrations.CreateModel(
            name='VirtualminServer',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100, unique=True, verbose_name='Server Name')),
                ('hostname', models.CharField(max_length=255, unique=True, verbose_name='Hostname')),
                ('api_port', models.PositiveIntegerField(default=10000, verbose_name='API Port')),
                ('api_path', models.CharField(default='/virtual-server/remote.cgi', max_length=100, verbose_name='API Path')),
                ('use_ssl', models.BooleanField(default=True, verbose_name='Use SSL')),
                ('ssl_verify', models.BooleanField(default=True, verbose_name='Verify SSL Certificate')),
                ('ssl_cert_fingerprint', models.CharField(blank=True, max_length=128, verbose_name='SSL Certificate Fingerprint')),
                ('api_username', models.CharField(max_length=100, verbose_name='API Username')),
                ('encrypted_api_password', models.BinaryField(verbose_name='Encrypted API Password')),
                ('max_domains', models.PositiveIntegerField(default=1000, validators=[django.core.validators.MinValueValidator(1)], verbose_name='Maximum Domains')),
                ('max_disk_gb', models.PositiveIntegerField(blank=True, null=True, verbose_name='Maximum Disk Space (GB)')),
                ('max_bandwidth_gb', models.PositiveIntegerField(blank=True, null=True, verbose_name='Maximum Bandwidth (GB/month)')),
                ('status', models.CharField(choices=[('active', 'Active'), ('maintenance', 'Maintenance'), ('disabled', 'Disabled'), ('failed', 'Failed')], default='active', max_length=20, verbose_name='Status')),
                ('last_health_check', models.DateTimeField(blank=True, null=True)),
                ('health_check_error', models.TextField(blank=True)),
                ('weight', models.PositiveIntegerField(default=100, help_text='Server weight for load balancing (higher = more capacity)')),
                ('region', models.CharField(blank=True, help_text='Geographic region for placement decisions', max_length=50)),
                ('tags', models.JSONField(default=list, help_text='Server tags for placement policies')),
                ('current_domains', models.PositiveIntegerField(default=0)),
                ('current_disk_usage_gb', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10)),
                ('current_bandwidth_usage_gb', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Virtualmin Server',
                'verbose_name_plural': 'Virtualmin Servers',
                'db_table': 'virtualmin_servers',
                'ordering': ('name',),
            },
        ),
        migrations.CreateModel(
            name='Server',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='Server Name')),
                ('hostname', models.CharField(max_length=255, unique=True, verbose_name='Hostname')),
                ('server_type', models.CharField(choices=[('shared', 'Shared Server'), ('vps_host', 'VPS Host'), ('dedicated', 'Dedicated Server'), ('cloud', 'Cloud Node')], max_length=20, verbose_name='Server Type')),
                ('primary_ip', models.GenericIPAddressField(verbose_name='Primary IP')),
                ('secondary_ips', models.JSONField(blank=True, default=list, verbose_name='Secondary IPs')),
                ('location', models.CharField(max_length=100, verbose_name='Location')),
                ('datacenter', models.CharField(max_length=100, verbose_name='Datacenter')),
                ('cpu_model', models.CharField(max_length=200, verbose_name='CPU Model')),
                ('cpu_cores', models.PositiveIntegerField(verbose_name='CPU Cores')),
                ('ram_gb', models.PositiveIntegerField(verbose_name='RAM (GB)')),
                ('disk_type', models.CharField(max_length=50, verbose_name='Disk Type')),
                ('disk_capacity_gb', models.PositiveIntegerField(verbose_name='Disk Capacity (GB)')),
                ('status', models.CharField(choices=[('active', 'Active'), ('maintenance', 'Under Maintenance'), ('offline', 'Offline'), ('decommissioned', 'Decommissioned')], default='active', max_length=20, verbose_name='Status')),
                ('cpu_usage_percent', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='CPU Usage (%)')),
                ('ram_usage_percent', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='RAM Usage (%)')),
                ('disk_usage_percent', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='Disk Usage (%)')),
                ('max_services', models.PositiveIntegerField(blank=True, null=True, verbose_name='Maximum Services')),
                ('os_type', models.CharField(max_length=100, verbose_name='Operating System')),
                ('control_panel', models.CharField(blank=True, max_length=100, verbose_name='Control Panel')),
                ('management_api_url', models.URLField(blank=True, verbose_name='Management API URL')),
                ('management_api_key', models.TextField(blank=True, default='', verbose_name='Encrypted API Key')),
                ('management_api_secret', models.TextField(blank=True, default='', verbose_name='Encrypted API Secret')),
                ('management_webhook_secret', models.CharField(blank=True, default='', max_length=255, verbose_name='Webhook Secret for signature verification')),
                ('provider', models.CharField(blank=True, max_length=100, verbose_name='Provider')),
                ('provider_instance_id', models.CharField(blank=True, max_length=100, verbose_name='Instance ID')),
                ('monthly_cost', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Monthly Cost (RON)')),
                ('last_maintenance', models.DateTimeField(blank=True, null=True, verbose_name='Last Maintenance')),
                ('next_maintenance', models.DateTimeField(blank=True, null=True, verbose_name='Next Maintenance')),
                ('is_active', models.BooleanField(default=True, verbose_name='Active')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Server',
                'verbose_name_plural': 'Servers',
                'db_table': 'servers',
                'ordering': ('location', 'name'),
                'indexes': [models.Index(fields=['status', 'server_type'], name='servers_status_ffec70_idx'), models.Index(fields=['location'], name='servers_locatio_5f4813_idx'), models.Index(fields=['primary_ip'], name='servers_primary_1e48fd_idx')],
            },
        ),
        migrations.CreateModel(
            name='Service',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('service_name', models.CharField(max_length=200, verbose_name='Service Name')),
                ('domain', models.CharField(blank=True, max_length=255, verbose_name='Primary Domain')),
                ('username', models.CharField(max_length=100, unique=True, verbose_name='System Username')),
                ('billing_cycle', models.CharField(choices=[('monthly', 'Monthly'), ('quarterly', 'Quarterly'), ('semi_annual', 'Semi-Annual'), ('annual', 'Annual')], default='monthly', max_length=20, verbose_name='Billing Cycle')),
                ('price', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Price (RON)')),
                ('setup_fee_paid', models.BooleanField(default=False, verbose_name='Setup Fee Paid')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('provisioning', 'Provisioning'), ('active', 'Active'), ('suspended', 'Suspended'), ('terminated', 'Terminated'), ('expired', 'Expired')], default='pending', max_length=20, verbose_name='Status')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Created At')),
                ('activated_at', models.DateTimeField(blank=True, null=True, verbose_name='Activated At')),
                ('suspended_at', models.DateTimeField(blank=True, null=True, verbose_name='Suspended At')),
                ('expires_at', models.DateTimeField(blank=True, null=True, verbose_name='Expires At')),
                ('provisioning_data', models.JSONField(blank=True, default=dict, verbose_name='Provisioning Data')),
                ('last_provisioning_attempt', models.DateTimeField(blank=True, null=True, verbose_name='Last Provisioning Attempt')),
                ('provisioning_errors', models.TextField(blank=True, verbose_name='Provisioning Errors')),
                ('disk_usage_mb', models.PositiveIntegerField(default=0, verbose_name='Disk Usage (MB)')),
                ('bandwidth_usage_mb', models.PositiveIntegerField(default=0, verbose_name='Bandwidth Used (MB)')),
                ('email_accounts_used', models.PositiveIntegerField(default=0, verbose_name='Email Accounts Used')),
                ('databases_used', models.PositiveIntegerField(default=0, verbose_name='Databases Used')),
                ('auto_renew', models.BooleanField(default=True, verbose_name='Auto Renew')),
                ('admin_notes', models.TextField(blank=True, verbose_name='Admin Notes')),
                ('suspension_reason', models.TextField(blank=True, verbose_name='Suspension Reason')),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('customer', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='services', to='customers.customer', verbose_name='Customer')),
                ('server', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='services', to='provisioning.server', verbose_name='Server')),
            ],
            options={
                'verbose_name': 'Service',
                'verbose_name_plural': 'Services',
                'db_table': 'services',
                'ordering': ('-created_at',),
            },
        ),
        migrations.CreateModel(
            name='ProvisioningTask',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('task_type', models.CharField(choices=[('create_service', 'Create Service'), ('suspend_service', 'Suspend Service'), ('unsuspend_service', 'Unsuspend Service'), ('terminate_service', 'Terminate Service'), ('update_service', 'Update Service'), ('backup_service', 'Backup Service')], max_length=30, verbose_name='Task Type')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('running', 'Running'), ('completed', 'Completed'), ('failed', 'Failed'), ('retrying', 'Retrying')], default='pending', max_length=20, verbose_name='Status')),
                ('parameters', models.JSONField(blank=True, default=dict, verbose_name='Parameters')),
                ('started_at', models.DateTimeField(blank=True, null=True, verbose_name='Started At')),
                ('completed_at', models.DateTimeField(blank=True, null=True, verbose_name='Completed At')),
                ('result', models.JSONField(blank=True, default=dict, verbose_name='Result')),
                ('error_message', models.TextField(blank=True, verbose_name='Error Message')),
                ('retry_count', models.PositiveIntegerField(default=0, verbose_name='Retry Count')),
                ('max_retries', models.PositiveIntegerField(default=3, verbose_name='Max Retries')),
                ('next_retry_at', models.DateTimeField(blank=True, null=True, verbose_name='Next Retry At')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('service', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='provisioning_tasks', to='provisioning.service', verbose_name='Service')),
            ],
            options={
                'verbose_name': 'Provisioning Task',
                'verbose_name_plural': 'Provisioning Tasks',
                'db_table': 'provisioning_tasks',
                'ordering': ('-created_at',),
            },
        ),
        migrations.CreateModel(
            name='ServiceDomain',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('domain_type', models.CharField(choices=[('primary', 'üéØ Primary Domain'), ('addon', '+ Add-on Domain'), ('subdomain', 'üîó Subdomain'), ('redirect', '‚Ü©Ô∏è Domain Redirect'), ('parking', 'üÖøÔ∏è Parked Domain')], default='primary', help_text='How domain is used with service', max_length=20)),
                ('subdomain', models.CharField(blank=True, help_text="Subdomain prefix (e.g., 'blog' for blog.example.com)", max_length=100)),
                ('dns_management', models.BooleanField(default=True, help_text='Manage DNS records for this domain')),
                ('ssl_enabled', models.BooleanField(default=False, help_text='SSL certificate enabled for this domain')),
                ('ssl_type', models.CharField(choices=[('none', 'No SSL'), ('shared', 'Shared SSL'), ('dedicated', 'Dedicated SSL'), ('wildcard', 'Wildcard SSL')], default='none', max_length=20)),
                ('redirect_url', models.URLField(blank=True, help_text='Redirect target URL (for redirect type)')),
                ('redirect_type', models.CharField(blank=True, choices=[('301', '301 Permanent'), ('302', '302 Temporary')], default='301', max_length=20)),
                ('email_routing', models.BooleanField(default=False, help_text='Handle email for this domain')),
                ('catch_all_email', models.EmailField(blank=True, help_text='Catch-all email address', max_length=254)),
                ('is_active', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('domain', models.ForeignKey(help_text='Domain assigned to service', on_delete=django.db.models.deletion.CASCADE, related_name='services', to='domains.domain')),
                ('service', models.ForeignKey(help_text='Hosting service for this domain', on_delete=django.db.models.deletion.CASCADE, related_name='domains', to='provisioning.service')),
            ],
            options={
                'verbose_name': 'üåê Service Domain',
                'verbose_name_plural': 'üåê Service Domains',
                'ordering': ('-created_at',),
            },
        ),
        migrations.CreateModel(
            name='ServiceGroup',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text='Service group name', max_length=100)),
                ('description', models.TextField(blank=True, help_text='Description of service group')),
                ('group_type', models.CharField(choices=[('package', 'üì¶ Hosting Package'), ('cluster', 'üîó Service Cluster'), ('bundle', 'üéÅ Product Bundle'), ('environment', 'üèóÔ∏è Environment'), ('reseller', 'üë• Reseller Package')], help_text='Type of service group', max_length=20)),
                ('status', models.CharField(choices=[('active', 'üü¢ Active'), ('suspended', 'üü° Suspended'), ('cancelled', 'üî¥ Cancelled'), ('pending', '‚è≥ Pending Setup')], default='pending', max_length=20)),
                ('billing_cycle', models.CharField(choices=[('monthly', 'Monthly'), ('quarterly', 'Quarterly'), ('yearly', 'Yearly'), ('one_time', 'One Time')], default='monthly', max_length=20)),
                ('auto_provision', models.BooleanField(default=True, help_text='Automatically provision all services in group')),
                ('coordinated_billing', models.BooleanField(default=True, help_text='Generate single invoice for all services')),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('customer', models.ForeignKey(help_text='Customer owning this service group', on_delete=django.db.models.deletion.CASCADE, related_name='service_groups', to='customers.customer')),
            ],
            options={
                'verbose_name': 'üì¶ Service Group',
                'verbose_name_plural': 'üì¶ Service Groups',
                'ordering': ('-created_at',),
            },
        ),
        migrations.CreateModel(
            name='ServiceGroupMember',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('member_role', models.CharField(choices=[('primary', 'üéØ Primary Service'), ('dependency', '‚ö° Dependency'), ('addon', 'üîß Add-on'), ('backup', 'üíæ Backup Service')], default='primary', help_text='Role of service in group', max_length=20)),
                ('provision_order', models.PositiveIntegerField(default=1, help_text='Order for provisioning (1 = first)')),
                ('billing_override', models.BooleanField(default=False, help_text='Override individual service billing')),
                ('custom_price_cents', models.BigIntegerField(blank=True, help_text='Custom price for this service in group', null=True, validators=[django.core.validators.MinValueValidator(0)])),
                ('is_active', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True)),
                ('joined_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('group', models.ForeignKey(help_text='Service group', on_delete=django.db.models.deletion.CASCADE, related_name='members', to='provisioning.servicegroup')),
                ('service', models.ForeignKey(help_text='Service in group', on_delete=django.db.models.deletion.CASCADE, related_name='group_memberships', to='provisioning.service')),
            ],
            options={
                'verbose_name': 'üë• Service Group Member',
                'verbose_name_plural': 'üë• Service Group Members',
                'ordering': ('provision_order', 'joined_at'),
            },
        ),
        migrations.CreateModel(
            name='ServicePlan',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, verbose_name='Plan Name')),
                ('plan_type', models.CharField(choices=[('shared_hosting', 'Shared Web Hosting'), ('vps', 'VPS'), ('dedicated', 'Dedicated Server'), ('cloud', 'Cloud Hosting'), ('domain', 'Domain'), ('ssl', 'SSL Certificate'), ('email', 'Email Hosting'), ('backup', 'Backup'), ('maintenance', 'Maintenance')], max_length=30, verbose_name='Plan Type')),
                ('description', models.TextField(blank=True, verbose_name='Description')),
                ('price_monthly', models.DecimalField(decimal_places=2, max_digits=10, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Monthly Price (RON)')),
                ('price_quarterly', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Quarterly Price (RON)')),
                ('price_annual', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Annual Price (RON)')),
                ('setup_fee', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Setup Fee (RON)')),
                ('features', models.JSONField(default=dict, help_text='Technical specifications and features in JSON format', verbose_name='Features')),
                ('disk_space_gb', models.PositiveIntegerField(blank=True, null=True, verbose_name='Disk Space (GB)')),
                ('bandwidth_gb', models.PositiveIntegerField(blank=True, null=True, verbose_name='Monthly Traffic (GB)')),
                ('email_accounts', models.PositiveIntegerField(blank=True, null=True, verbose_name='Email Accounts')),
                ('databases', models.PositiveIntegerField(blank=True, null=True, verbose_name='Databases')),
                ('domains', models.PositiveIntegerField(blank=True, null=True, verbose_name='Domains')),
                ('cpu_cores', models.PositiveIntegerField(blank=True, null=True, verbose_name='CPU Cores')),
                ('ram_gb', models.PositiveIntegerField(blank=True, null=True, verbose_name='RAM (GB)')),
                ('includes_vat', models.BooleanField(default=False, verbose_name='Price Includes VAT')),
                ('is_active', models.BooleanField(default=True, verbose_name='Active')),
                ('is_public', models.BooleanField(default=True, verbose_name='Public on Website')),
                ('sort_order', models.PositiveIntegerField(default=0, verbose_name='Sort Order')),
                ('auto_provision', models.BooleanField(default=False, verbose_name='Auto Provision')),
                ('provisioning_script', models.TextField(blank=True, verbose_name='Provisioning Script')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Service Plan',
                'verbose_name_plural': 'Service Plans',
                'db_table': 'service_plans',
                'ordering': ('plan_type', 'sort_order', 'price_monthly'),
                'indexes': [models.Index(fields=['plan_type', 'is_active'], name='service_pla_plan_ty_8f3dd0_idx'), models.Index(fields=['is_public', 'is_active'], name='service_pla_is_publ_1b98fb_idx')],
            },
        ),
        migrations.AddField(
            model_name='service',
            name='service_plan',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='provisioning.serviceplan', verbose_name='Service Plan'),
        ),
        migrations.CreateModel(
            name='ServiceRelationship',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('relationship_type', models.CharField(choices=[('addon', 'üîß Add-on Service'), ('included', 'üì¶ Included Service'), ('dependency', '‚ö° Required Dependency'), ('upgrade', '‚¨ÜÔ∏è Service Upgrade'), ('bundle', 'üéÅ Bundle Component')], help_text='Type of service relationship', max_length=20)),
                ('billing_impact', models.CharField(choices=[('separate', 'üí≥ Billed Separately'), ('included', 'üÜì Included in Parent'), ('discounted', 'üí∞ Discounted Rate'), ('prorated', 'üìä Prorated Billing')], default='separate', help_text='How this affects customer billing', max_length=20)),
                ('is_required', models.BooleanField(default=False, help_text='Child service is required for parent to function')),
                ('auto_provision', models.BooleanField(default=False, help_text='Automatically provision child when parent is created')),
                ('cascade_suspend', models.BooleanField(default=False, help_text='Suspend child service when parent is suspended')),
                ('cascade_terminate', models.BooleanField(default=False, help_text='Terminate child service when parent is terminated')),
                ('discount_percentage', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Discount percentage for bundle pricing', max_digits=5, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('fixed_discount_cents', models.BigIntegerField(default=0, help_text='Fixed discount amount in cents', validators=[django.core.validators.MinValueValidator(0)])),
                ('is_active', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('child_service', models.ForeignKey(help_text='Related service (e.g., domain, SSL, backup)', on_delete=django.db.models.deletion.CASCADE, related_name='parent_relationships', to='provisioning.service')),
                ('parent_service', models.ForeignKey(help_text='Primary service (e.g., VPS hosting)', on_delete=django.db.models.deletion.CASCADE, related_name='child_relationships', to='provisioning.service')),
            ],
            options={
                'verbose_name': 'üîó Service Relationship',
                'verbose_name_plural': 'üîó Service Relationships',
                'ordering': ('-created_at',),
            },
        ),
    ]
