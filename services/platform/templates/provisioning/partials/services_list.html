{% load i18n %}

<!-- =============================================================================== -->
<!-- PROVISIONING SERVICES LIST - STANDARD TABLE -->
<!-- =============================================================================== -->

<div class="bg-slate-800 rounded-lg overflow-hidden">
  <!-- Services Count Header -->
  <div class="px-4 sm:px-6 py-4 border-b border-slate-700">
    <!-- Desktop Layout -->
    <div class="hidden sm:flex items-center justify-between">
      <div class="flex items-center space-x-4">
        <h3 class="text-lg font-medium text-white">ğŸ“¦ {% trans 'Services' %}</h3>

        <!-- Service Count Badge -->
        <div class="bg-blue-600/20 text-blue-400 px-3 py-1 rounded-full text-sm font-medium">
          {% if services.paginator.count == 1 %}
            1 {% trans 'service' %}
          {% else %}
            {{ services.paginator.count }} {% trans 'services' %}
          {% endif %}
        </div>

        {% if status_filter %}
        <div class="bg-purple-600/20 text-purple-400 px-3 py-1 rounded-full text-sm">
          {% trans 'Filter:' %} {{ status_filter|title }}
        </div>
        {% endif %}
      </div>

      <!-- Quick Stats -->
      <div class="flex items-center space-x-4 text-sm">
        <div class="{% if display_status == 'active' %}text-green-400{% elif display_status == 'suspended' %}text-red-400{% elif display_status == 'pending' %}text-yellow-400{% elif display_status == 'provisioning' %}text-blue-400{% elif display_status == 'terminated' %}text-gray-400{% elif display_status == 'expired' %}text-orange-400{% else %}text-blue-400{% endif %}">
          {% if display_status == 'active' %}âœ…{% elif display_status == 'suspended' %}â¸ï¸{% elif display_status == 'pending' %}â³{% elif display_status == 'provisioning' %}ğŸ”„{% elif display_status == 'terminated' %}ğŸ’€{% elif display_status == 'expired' %}â°{% else %}ğŸ“Š{% endif %}
          {{ active_count }}
          {% if display_status == 'active' %}{% trans 'active' %}{% elif display_status == 'suspended' %}{% trans 'suspended' %}{% elif display_status == 'pending' %}{% trans 'pending' %}{% elif display_status == 'provisioning' %}{% trans 'provisioning' %}{% elif display_status == 'terminated' %}{% trans 'terminated' %}{% elif display_status == 'expired' %}{% trans 'expired' %}{% else %}{% trans 'services' %}{% endif %}
        </div>
        <div class="text-slate-400">
          ğŸ“Š {{ total_count }} {% trans 'total' %}
        </div>
      </div>
    </div>

    <!-- Mobile Layout -->
    <div class="sm:hidden">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-lg font-medium text-white">ğŸ“¦ {% trans 'Services' %}</h3>
        <div class="bg-blue-600/20 text-blue-400 px-3 py-1 rounded-full text-sm font-medium">
          {% if services.paginator.count == 1 %}
            1 {% trans 'service' %}
          {% else %}
            {{ services.paginator.count }} {% trans 'services' %}
          {% endif %}
        </div>
      </div>

      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3 text-sm">
          <div class="{% if display_status == 'active' %}text-green-400{% elif display_status == 'suspended' %}text-red-400{% elif display_status == 'pending' %}text-yellow-400{% elif display_status == 'provisioning' %}text-blue-400{% elif display_status == 'terminated' %}text-gray-400{% elif display_status == 'expired' %}text-orange-400{% else %}text-blue-400{% endif %}">
            {% if display_status == 'active' %}âœ…{% elif display_status == 'suspended' %}â¸ï¸{% elif display_status == 'pending' %}â³{% elif display_status == 'provisioning' %}ğŸ”„{% elif display_status == 'terminated' %}ğŸ’€{% elif display_status == 'expired' %}â°{% else %}ğŸ“Š{% endif %}
            {{ active_count }}
            {% if display_status == 'active' %}{% trans 'active' %}{% elif display_status == 'suspended' %}{% trans 'suspended' %}{% elif display_status == 'pending' %}{% trans 'pending' %}{% elif display_status == 'provisioning' %}{% trans 'provisioning' %}{% elif display_status == 'terminated' %}{% trans 'terminated' %}{% elif display_status == 'expired' %}{% trans 'expired' %}{% else %}{% trans 'services' %}{% endif %}
          </div>
          <div class="text-slate-400">ğŸ“Š {{ total_count }} {% trans 'total' %}</div>
        </div>

        {% if status_filter %}
        <div class="bg-purple-600/20 text-purple-400 px-2 py-1 rounded-full text-xs">
          {{ status_filter|title }}
        </div>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Desktop Table View -->
  {% if services %}
  <div class="hidden sm:block overflow-x-auto">
    <table class="min-w-full divide-y divide-slate-700">
      <thead class="bg-slate-700">
        <tr>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Service Name' %}
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Customer' %}
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Plan' %}
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Price' %}
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Status' %}
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Creation Date' %}
          </th>
          {% if can_manage_services %}
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Actions' %}
          </th>
          {% endif %}
        </tr>
      </thead>
      <tbody class="bg-slate-800 divide-y divide-slate-700">
        {% for service in services %}
        <tr class="hover:bg-slate-700 transition-colors cursor-pointer"
            onclick="window.location.href='{% url 'provisioning:service_detail' service.pk %}'">
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-medium text-white">{{ service.service_name }}</div>
            {% if service.domain %}
            <div class="text-sm text-slate-400">{{ service.domain }}</div>
            {% endif %}
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-slate-300">{{ service.customer.get_display_name }}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-slate-300">{{ service.service_plan.name }}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-mono text-green-400">â‚¾{{ service.price }}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            {% if service.status == 'active' %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
              {% trans 'Active' %}
            </span>
            {% elif service.status == 'suspended' %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
              {% trans 'Suspended' %}
            </span>
            {% elif service.status == 'pending' %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
              {% trans 'Pending' %}
            </span>
            {% elif service.status == 'provisioning' %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
              {% trans 'Provisioning' %}
            </span>
            {% elif service.status == 'terminated' %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
              {% trans 'Terminated' %}
            </span>
            {% elif service.status == 'expired' %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-orange-100 text-orange-800">
              {% trans 'Expired' %}
            </span>
            {% else %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
              {{ service.get_status_display }}
            </span>
            {% endif %}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-400">
            {{ service.created_at|date:"M d, Y" }}
          </td>
          {% if can_manage_services %}
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium" onclick="event.stopPropagation();">
            <div class="flex space-x-2">
              <a href="{% url 'provisioning:service_edit' service.pk %}"
                 class="text-blue-400 hover:text-blue-300 transition-colors">
                âœï¸
              </a>
              {% if service.status == 'active' %}
              <button onclick="confirmSuspend('{{ service.pk }}', '{{ service.service_name }}')"
                      class="text-red-400 hover:text-red-300 transition-colors">
                â¸ï¸
              </button>
              {% elif service.status == 'suspended' %}
              <button onclick="confirmReactivate('{{ service.pk }}', '{{ service.service_name }}')"
                      class="text-green-400 hover:text-green-300 transition-colors">
                â–¶ï¸
              </button>
              {% endif %}
            </div>
          </td>
          {% endif %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Mobile Card View -->
  <div class="sm:hidden divide-y divide-slate-700">
    {% for service in services %}
    <div class="p-4 hover:bg-slate-750 transition-colors cursor-pointer"
         onclick="window.location.href='{% url 'provisioning:service_detail' service.pk %}'">
      <div class="flex items-start justify-between mb-3">
        <div class="flex-1">
          <div class="text-sm font-medium text-white">{{ service.service_name }}</div>
          {% if service.domain %}
          <div class="text-xs text-slate-400 mt-1">{{ service.domain }}</div>
          {% endif %}
          <div class="text-xs text-slate-500 mt-1">{{ service.customer.get_display_name }}</div>
        </div>
        <div class="ml-3">
          {% if service.status == 'active' %}
          <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
            {% trans 'Active' %}
          </span>
          {% elif service.status == 'suspended' %}
          <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
            {% trans 'Suspended' %}
          </span>
          {% elif service.status == 'pending' %}
          <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
            {% trans 'Pending' %}
          </span>
          {% elif service.status == 'provisioning' %}
          <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
            {% trans 'Provisioning' %}
          </span>
          {% elif service.status == 'terminated' %}
          <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
            {% trans 'Terminated' %}
          </span>
          {% elif service.status == 'expired' %}
          <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-orange-100 text-orange-800">
            {% trans 'Expired' %}
          </span>
          {% else %}
          <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
            {{ service.get_status_display }}
          </span>
          {% endif %}
        </div>
      </div>

      <div class="grid grid-cols-2 gap-3 mb-3">
        <div>
          <div class="text-xs text-slate-400 uppercase tracking-wide">{% trans 'Plan' %}</div>
          <div class="text-sm text-slate-300">{{ service.service_plan.name }}</div>
        </div>
        <div>
          <div class="text-xs text-slate-400 uppercase tracking-wide">{% trans 'Price' %}</div>
          <div class="text-sm font-mono text-green-400">â‚¾{{ service.price }}</div>
        </div>
      </div>

      <div class="flex items-center justify-between">
        <div>
          <div class="text-xs text-slate-400 uppercase tracking-wide">{% trans 'Created' %}</div>
          <div class="text-sm text-slate-300">{{ service.created_at|date:"M d, Y" }}</div>
        </div>
        {% if can_manage_services %}
        <div class="flex space-x-2" onclick="event.stopPropagation();">
          <a href="{% url 'provisioning:service_edit' service.pk %}"
             class="text-blue-400 hover:text-blue-300 transition-colors text-sm">
            âœï¸
          </a>
          {% if service.status == 'active' %}
          <button onclick="confirmSuspend('{{ service.pk }}', '{{ service.service_name }}')"
                  class="text-red-400 hover:text-red-300 transition-colors text-sm">
            â¸ï¸
          </button>
          {% elif service.status == 'suspended' %}
          <button onclick="confirmReactivate('{{ service.pk }}', '{{ service.service_name }}')"
                  class="text-green-400 hover:text-green-300 transition-colors text-sm">
            â–¶ï¸
          </button>
          {% endif %}
        </div>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <!-- Empty State -->
  <div class="text-center py-12">
    <div class="text-slate-400 text-lg mb-4">
      {% if status_filter %}
        ğŸ“‹ {% trans 'No services found for the selected filter' %}
      {% else %}
        ğŸ“¦ {% trans 'No services yet' %}
      {% endif %}
    </div>
    {% if not status_filter and can_manage_services %}
    <a href="{% url 'provisioning:service_create' %}"
       class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-md inline-flex items-center transition-colors">
      <span class="mr-2">â•</span>
      {% trans 'Create the first service' %}
    </a>
    {% endif %}
  </div>
  {% endif %}

  <!-- Pagination -->
  {% if services.has_other_pages %}
  <div class="bg-slate-700 px-4 sm:px-6 py-3 border-t border-slate-600">
    <div class="flex items-center justify-between">
      <!-- Page Range Info -->
      <div class="text-sm text-slate-400">
        {% with start_index=services.start_index end_index=services.end_index total_count=services.paginator.count %}
          {% blocktrans %}Page {{ page_number }} of {{ num_pages }}{% endblocktrans %}
        {% endwith %}
      </div>

      <!-- Navigation Controls -->
      <div class="flex space-x-1">
        {% if services.has_previous %}
        <a href="?page={{ services.previous_page_number }}{% if status_filter %}&status={{ status_filter }}{% endif %}"
           class="bg-slate-600 hover:bg-slate-500 text-white px-2 sm:px-3 py-1 rounded text-xs sm:text-sm transition-colors">
          {% trans 'Previous' %}
        </a>
        {% endif %}

        {% if services.has_next %}
        <a href="?page={{ services.next_page_number }}{% if status_filter %}&status={{ status_filter }}{% endif %}"
           class="bg-slate-600 hover:bg-slate-500 text-white px-2 sm:px-3 py-1 rounded text-xs sm:text-sm transition-colors">
          {% trans 'Next' %}
        </a>
        {% endif %}
      </div>
    </div>
  </div>
  {% endif %}
</div>

<!-- Service Actions JavaScript -->
<script>
function confirmSuspend(serviceId, serviceName) {
  if (confirm('{% trans "Suspend service?" %} ' + serviceName)) {
    window.location.href = '/app/provisioning/services/' + serviceId + '/suspend/';
  }
}

function confirmReactivate(serviceId, serviceName) {
  if (confirm('{% trans "Reactivate service?" %} ' + serviceName)) {
    window.location.href = '/app/provisioning/services/' + serviceId + '/activate/';
  }
}
</script>
