{% load i18n %}

<!-- =============================================================================== -->
<!-- PROVISIONING SERVICES LIST - STANDARD TABLE -->
<!-- =============================================================================== -->

<div class="bg-slate-800 rounded-lg overflow-hidden">
  <!-- Services Count Header -->
  <div class="px-6 py-4 border-b border-slate-700">
    <div class="flex items-center justify-between">
      <div class="flex items-center space-x-4">
        <h3 class="text-lg font-medium text-white">üì¶ {% trans 'Services' %}</h3>
        
        <!-- Service Count Badge -->
        <div class="bg-blue-600/20 text-blue-400 px-3 py-1 rounded-full text-sm font-medium">
          {% if services.paginator.count == 1 %}
            1 {% trans 'service' %}
          {% else %}
            {{ services.paginator.count }} {% trans 'services' %}
          {% endif %}
        </div>
        
        {% if status_filter %}
        <div class="bg-purple-600/20 text-purple-400 px-3 py-1 rounded-full text-sm">
          {% trans 'Filter:' %} {{ status_filter|title }}
        </div>
        {% endif %}
      </div>

      <!-- Quick Stats -->
      <div class="flex items-center space-x-4 text-sm">
        <div class="text-green-400">
          ‚úÖ {{ active_count }} {% trans 'active' %}
        </div>
        <div class="text-slate-400">
          üìä {{ total_count }} {% trans 'total' %}
        </div>
      </div>
    </div>
  </div>

  <!-- Services Table -->
  {% if services %}
  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-slate-700">
      <thead class="bg-slate-700">
        <tr>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Service Name' %}
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Customer' %}
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Plan' %}
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Price' %}
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Status' %}
          </th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Creation Date' %}
          </th>
          {% if can_manage_services %}
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider">
            {% trans 'Actions' %}
          </th>
          {% endif %}
        </tr>
      </thead>
      <tbody class="bg-slate-800 divide-y divide-slate-700">
        {% for service in services %}
        <tr class="hover:bg-slate-700 transition-colors cursor-pointer" 
            onclick="window.location.href='{% url 'provisioning:service_detail' service.pk %}'">
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-medium text-white">{{ service.service_name }}</div>
            {% if service.domain %}
            <div class="text-sm text-slate-400">{{ service.domain }}</div>
            {% endif %}
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-slate-300">{{ service.customer.get_display_name }}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-slate-300">{{ service.service_plan.name }}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-mono text-green-400">‚Çæ{{ service.price }}</div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            {% if service.status == 'active' %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
              {% trans 'Active' %}
            </span>
            {% elif service.status == 'suspended' %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
              {% trans 'Suspended' %}
            </span>
            {% elif service.status == 'pending' %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
              {% trans 'Pending' %}
            </span>
            {% elif service.status == 'provisioning' %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
              {% trans 'Provisioning' %}
            </span>
            {% elif service.status == 'terminated' %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
              {% trans 'Terminated' %}
            </span>
            {% elif service.status == 'expired' %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-orange-100 text-orange-800">
              {% trans 'Expired' %}
            </span>
            {% else %}
            <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
              {{ service.get_status_display }}
            </span>
            {% endif %}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-400">
            {{ service.created_at|date:"M d, Y" }}
          </td>
          {% if can_manage_services %}
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium" onclick="event.stopPropagation();">
            <div class="flex space-x-2">
              <a href="{% url 'provisioning:service_edit' service.pk %}" 
                 class="text-blue-400 hover:text-blue-300 transition-colors">
                ‚úèÔ∏è
              </a>
              {% if service.status == 'active' %}
              <button onclick="confirmSuspend('{{ service.pk }}', '{{ service.service_name }}')"
                      class="text-red-400 hover:text-red-300 transition-colors">
                ‚è∏Ô∏è
              </button>
              {% elif service.status == 'suspended' %}
              <button onclick="confirmReactivate('{{ service.pk }}', '{{ service.service_name }}')"
                      class="text-green-400 hover:text-green-300 transition-colors">
                ‚ñ∂Ô∏è
              </button>
              {% endif %}
            </div>
          </td>
          {% endif %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <!-- Empty State -->
  <div class="text-center py-12">
    <div class="text-slate-400 text-lg mb-4">
      {% if status_filter %}
        üìã {% trans 'No services found for the selected filter' %}
      {% else %}
        üì¶ {% trans 'No services yet' %}
      {% endif %}
    </div>
    {% if not status_filter and can_manage_services %}
    <a href="{% url 'provisioning:service_create' %}"
       class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-md inline-flex items-center transition-colors">
      <span class="mr-2">‚ûï</span>
      {% trans 'Create the first service' %}
    </a>
    {% endif %}
  </div>
  {% endif %}

  <!-- Pagination -->
  {% if services.has_other_pages %}
  <div class="bg-slate-700 px-6 py-3 border-t border-slate-600">
    <div class="flex items-center justify-between">
      <!-- Page Range Info -->
      <div class="text-sm text-slate-400">
        {% with start_index=services.start_index end_index=services.end_index total_count=services.paginator.count %}
          {% blocktrans %}Page {{ page_number }} of {{ num_pages }}{% endblocktrans %}
        {% endwith %}
      </div>

      <!-- Navigation Controls -->
      <div class="flex space-x-1">
        {% if services.has_previous %}
        <a href="?page={{ services.previous_page_number }}{% if status_filter %}&status={{ status_filter }}{% endif %}"
           class="bg-slate-600 hover:bg-slate-500 text-white px-3 py-1 rounded text-sm transition-colors">
          {% trans 'Previous' %}
        </a>
        {% endif %}

        {% if services.has_next %}
        <a href="?page={{ services.next_page_number }}{% if status_filter %}&status={{ status_filter }}{% endif %}"
           class="bg-slate-600 hover:bg-slate-500 text-white px-3 py-1 rounded text-sm transition-colors">
          {% trans 'Next' %}
        </a>
        {% endif %}
      </div>
    </div>
  </div>
  {% endif %}
</div>

<!-- Service Actions JavaScript -->
<script>
function confirmSuspend(serviceId, serviceName) {
  if (confirm('{% trans "Suspend service?" %} ' + serviceName)) {
    window.location.href = '/app/provisioning/services/' + serviceId + '/suspend/';
  }
}

function confirmReactivate(serviceId, serviceName) {
  if (confirm('{% trans "Reactivate service?" %} ' + serviceName)) {
    window.location.href = '/app/provisioning/services/' + serviceId + '/activate/';
  }
}
</script>
