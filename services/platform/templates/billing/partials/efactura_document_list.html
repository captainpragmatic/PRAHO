{% load i18n %}

{% if documents_page %}
<table class="min-w-full divide-y divide-slate-700">
  <thead>
    <tr>
      <th class="px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase">{% trans "Invoice" %}</th>
      <th class="px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase">{% trans "Status" %}</th>
      <th class="px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase">{% trans "Upload Index" %}</th>
      <th class="px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase">{% trans "Submitted" %}</th>
      <th class="px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase">{% trans "Retries" %}</th>
      <th class="px-4 py-3 text-right text-xs font-medium text-slate-400 uppercase">{% trans "Actions" %}</th>
    </tr>
  </thead>
  <tbody class="divide-y divide-slate-700">
    {% for doc in documents_page %}
    <tr class="hover:bg-slate-700/50">
      <td class="px-4 py-3 text-sm">
        <a href="{% url 'billing:efactura_document_detail' pk=doc.pk %}" class="text-blue-400 hover:text-blue-300">
          {{ doc.invoice.number }}
        </a>
      </td>
      <td class="px-4 py-3 text-sm">
        {% if doc.status == "accepted" %}
          <span class="inline-flex items-center rounded-full bg-green-900 px-2 py-0.5 text-xs font-medium text-green-300">✅ {{ doc.status }}</span>
        {% elif doc.status == "rejected" %}
          <span class="inline-flex items-center rounded-full bg-red-900 px-2 py-0.5 text-xs font-medium text-red-300">❌ {{ doc.status }}</span>
        {% elif doc.status == "error" %}
          <span class="inline-flex items-center rounded-full bg-orange-900 px-2 py-0.5 text-xs font-medium text-orange-300">⚠️ {{ doc.status }}</span>
        {% elif doc.status == "processing" or doc.status == "submitted" %}
          <span class="inline-flex items-center rounded-full bg-yellow-900 px-2 py-0.5 text-xs font-medium text-yellow-300">⏳ {{ doc.status }}</span>
        {% else %}
          <span class="inline-flex items-center rounded-full bg-slate-700 px-2 py-0.5 text-xs font-medium text-slate-300">{{ doc.status }}</span>
        {% endif %}
      </td>
      <td class="px-4 py-3 text-sm text-slate-400 font-mono text-xs">
        {{ doc.anaf_upload_index|default:"-"|truncatechars:20 }}
      </td>
      <td class="px-4 py-3 text-sm text-slate-400">
        {{ doc.submitted_at|date:"d M Y H:i"|default:"-" }}
      </td>
      <td class="px-4 py-3 text-sm text-slate-400">
        {{ doc.retry_count }}
      </td>
      <td class="px-4 py-3 text-sm text-right">
        <a href="{% url 'billing:efactura_document_detail' pk=doc.pk %}" class="text-slate-400 hover:text-white text-xs">
          {% trans "Details" %}
        </a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- Pagination -->
{% if documents_page.has_other_pages %}
<div class="px-4 py-3 border-t border-slate-700 flex items-center justify-between">
  <p class="text-sm text-slate-400">
    {% trans "Page" %} {{ documents_page.number }} {% trans "of" %} {{ documents_page.paginator.num_pages }}
  </p>
  <div class="flex gap-2">
    {% if documents_page.has_previous %}
    <a href="?page={{ documents_page.previous_page_number }}{% if status_filter %}&status={{ status_filter }}{% endif %}" class="px-3 py-1 bg-slate-700 rounded text-sm text-slate-300 hover:bg-slate-600">{% trans "Previous" %}</a>
    {% endif %}
    {% if documents_page.has_next %}
    <a href="?page={{ documents_page.next_page_number }}{% if status_filter %}&status={{ status_filter }}{% endif %}" class="px-3 py-1 bg-slate-700 rounded text-sm text-slate-300 hover:bg-slate-600">{% trans "Next" %}</a>
    {% endif %}
  </div>
</div>
{% endif %}
{% else %}
<div class="px-4 py-8 text-center text-sm text-slate-500">
  {% trans "No e-Factura documents found." %}
</div>
{% endif %}
