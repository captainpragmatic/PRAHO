{% extends 'base.html' %}
{% load i18n %}

{% block title %}{% trans "Logs" %} - {{ deployment.hostname }}{% endblock %}

{% block content %}
<div class="bg-slate-900 min-h-screen">
    <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-3xl font-bold text-white">{% trans "Deployment Logs" %}</h1>
                <p class="text-slate-400 mt-1 font-mono">{{ deployment.hostname }}</p>
            </div>
            <a href="{% url 'infrastructure:deployment_detail' deployment.id %}"
               class="px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors">
                {% trans "Back to Deployment" %}
            </a>
        </div>

        <!-- Logs -->
        <div class="bg-slate-800 rounded-lg border border-slate-700">
            <div class="px-6 py-4 border-b border-slate-700 flex justify-between items-center">
                <h2 class="text-lg font-semibold text-white">{% trans "Full Log History" %}</h2>
                <span class="text-sm text-slate-400">{{ logs|length }} {% trans "entries" %}</span>
            </div>
            <div class="p-6">
                {% if logs %}
                <div class="space-y-2 font-mono text-sm max-h-[70vh] overflow-y-auto">
                    {% for log in logs %}
                    <div class="flex items-start space-x-3 py-2 {% if not forloop.last %}border-b border-slate-700{% endif %}">
                        <span class="text-slate-500 whitespace-nowrap">{{ log.created_at|date:"Y-m-d H:i:s" }}</span>
                        <span class="px-2 py-0.5 rounded text-xs
                            {% if log.level == 'ERROR' %}bg-red-500/20 text-red-400
                            {% elif log.level == 'WARNING' %}bg-yellow-500/20 text-yellow-400
                            {% elif log.level == 'INFO' %}bg-blue-500/20 text-blue-400
                            {% else %}bg-slate-500/20 text-slate-400{% endif %}">
                            {{ log.level }}
                        </span>
                        <span class="text-slate-400 whitespace-nowrap">[{{ log.stage }}]</span>
                        <span class="text-slate-200 flex-1 break-all">{{ log.message }}</span>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-slate-400 text-center py-8">{% trans "No logs available" %}</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
