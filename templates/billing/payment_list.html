{% extends "base.html" %}
{% load i18n %}
{% load formatting %}

{% block title %}{% trans "Payments" %} - PRAHO Platform{% endblock %}

{% block content %}
<div class="px-4 sm:px-6 lg:px-8">
  <!-- Header -->
  <div class="sm:flex sm:items-center">
    <div class="sm:flex-auto">
      <h1 class="text-2xl font-semibold text-white romanian-flag">
        {% trans "Payments" %}
      </h1>
      <p class="mt-2 text-sm text-slate-400">
        {% trans "Payment history and transactions" %}
      </p>
    </div>
  </div>

  <!-- Payments Table -->
  <div class="mt-8 bg-slate-800 shadow-sm ring-1 ring-slate-700 rounded-lg overflow-hidden">
    <table class="min-w-full divide-y divide-slate-700">
      <thead class="bg-slate-900">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">
            {% trans "Date" %}
          </th>
          <th class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">
            {% trans "Customer" %}
          </th>
          <th class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">
            {% trans "Method" %}
          </th>
          <th class="px-6 py-3 text-right text-xs font-medium text-slate-400 uppercase tracking-wider">
            {% trans "Amount" %}
          </th>
          <th class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">
            {% trans "Status" %}
          </th>
        </tr>
      </thead>
      <tbody class="bg-slate-800 divide-y divide-slate-700">
        {% for payment in payments %}
        <tr>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-white">
            {{ payment.created_at|date:"d.m.Y H:i" }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-white">
            {{ payment.customer.name }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-400">
            {{ payment.get_method_display }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-green-400 text-right">
            {{ payment.amount_cents|cents_to_currency|romanian_currency:payment.currency.code }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-white">
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
              {% if payment.status == 'succeeded' %}bg-green-100 text-green-800
              {% elif payment.status == 'pending' %}bg-yellow-100 text-yellow-800
              {% elif payment.status == 'failed' %}bg-red-100 text-red-800
              {% else %}bg-gray-100 text-gray-800{% endif %}">
              {{ payment.get_status_display }}
            </span>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" class="px-6 py-4 text-center text-sm text-slate-500">
            {% trans "No payments found" %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  
  <!-- Total Amount -->
  {% if total_amount %}
  <div class="mt-4 text-right">
    <p class="text-lg font-semibold text-white">
      {% trans "Total:" %} {{ total_amount|cents_to_currency|romanian_currency:"RON" }}
    </p>
  </div>
  {% endif %}
</div>
{% endblock %}